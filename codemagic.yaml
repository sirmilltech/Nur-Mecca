Windows User's Guide: Automatic Build Setup

We are switching to Automatic Signing to let Codemagic resolve the profile mismatch itself.

1. Verify Apple API Permissions (Crucial)

Go to App Store Connect -> Users and Access -> Integrations.

Find your Key.

Ensure "Access to Certificates, Identifiers and Profiles" is checked.

Ensure the Role is Admin or App Manager.

2. The Automatic codemagic.yaml

Copy this exactly into your codemagic.yaml file on your Windows machine:

workflows:
  ios-workflow:
    name: Nur-Mecca iOS Automatic Build
    max_build_duration: 60
    environment:
      groups:
        - apple_auth 
      vars:
        XCODE_PROJECT: "ios/App/App.xcodeproj"
        XCODE_SCHEME: "App"
        BUNDLE_ID: "com.milltech.nurmecca.app"
    scripts:
      - name: Install dependencies
        script: npm install
      - name: Capacitor Sync
        script: npx cap sync ios
      - name: Set up code signing
        script: |
          # This command automatically fetches/creates profiles
          app-store-connect fetch-signing-files "$BUNDLE_ID" --project "$XCODE_PROJECT" --create
      - name: Build iOS App
        script: |
          xcodebuild \
            -project "$XCODE_PROJECT" \
            -scheme "$XCODE_SCHEME" \
            -sdk iphoneos \
            -configuration Release \
            -archivePath build/ios/xcarchive/App.xcarchive \
            -allowProvisioningUpdates \
            clean archive
    artifacts:
      - build/ios/xcarchive/*.xcarchive